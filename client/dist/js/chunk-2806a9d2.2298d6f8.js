(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2806a9d2"],{3772:function(t,e,o){"use strict";var r=o("9f2b"),a=o.n(r);a.a},"7f39":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page roomList"},[o("section",{staticClass:"section section--mmt mb-3"},[t._m(0),o("div",{staticClass:"section__content"},[o("Error",{attrs:{errorMessage:t.errorMessage}}),o("p",{staticClass:"section__lead"},[t._v("Enter a room and start chatting!")]),t.rooms?o("div",{staticClass:"rooms"},[o("div",{staticClass:"rooms__header"},[o("div",{staticClass:"rooms__details"},[o("div",{staticClass:"rooms__details-item"},[t._v("\n                            Total Rooms:\n                            "),o("span",{staticClass:"badge badge--info"},[t._v(t._s(t.rooms.length))])]),o("div",{staticClass:"rooms__details-item"},[t._v("\n                            Private Rooms:\n                            "),o("span",{staticClass:"badge badge--danger"},[t._v(t._s(t.getPrivateRooms.length))])]),o("div",{staticClass:"rooms__details-item"},[t._v("\n                            Public Rooms:\n                            "),o("span",{staticClass:"badge badge--success"},[t._v(t._s(t.getPublicRooms.length))])])]),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchInput,expression:"searchInput",modifiers:{trim:!0}}],staticClass:"rooms__search-input",attrs:{type:"text",placeholder:"Search | Enter 'my_rooms' for a list of your created rooms"},domProps:{value:t.searchInput},on:{input:function(e){e.target.composing||(t.searchInput=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),o("transition",{attrs:{name:"slideDown"}},[o("ul",{staticClass:"rooms__list"},[t.filteredRooms.length>0?o("transition-group",{attrs:{name:"slideUp"}},t._l(t.filteredRooms,(function(e){return o("li",{key:e._id,staticClass:"rooms__list-item"},[o("a",{staticClass:"rooms__list-item-link",attrs:{href:"room/"+e._id},on:{click:function(o){return o.preventDefault(),t.handleRoomClick(e)}}},[o("div",{staticClass:"rooms__item-container"},[o("div",{staticClass:"rooms__item-details"},[o("p",[t._v(t._s(e.name))]),o("p",{class:{public:e.access,private:!e.access}},[t._v(t._s(!0===e.access?"Public":"Private"))]),o("p",[o("strong",[t._v("Users:")]),t._v("\n                                                "+t._s(e.users.length)+"\n                                            ")]),o("p",[o("strong",[t._v("Room Admin:")]),t._v("\n                                                "+t._s(e.user?e.user.handle:"Unknown User")+"\n                                            ")])]),o("div",{staticClass:"rooms__item-actions"},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.user&&t.getUserData._id===e.user._id,expression:"room.user && getUserData._id === room.user._id"}],staticClass:"rooms__item-action"},[o("a",{staticClass:"btn btn--danger",attrs:{name:e.name},on:{click:function(e){return e.stopPropagation(),t.handleDelete(e)}}},[t._v("Delete")])])])])])])})),0):o("span",[t._v("No Rooms")])],1)]),o("Modal",{ref:"privateRoom",attrs:{name:"private-room"}},[o("template",{slot:"header"},[o("h2",{staticClass:"text-upper"},[t._v("Enter "+t._s(this.privateRoomName||"Private Room"))])]),o("template",{slot:"body"},[o("form",{staticClass:"form form--nbs pt-3",attrs:{slot:"body"},on:{submit:t.handlePrivateRoomCheck},slot:"body"},[o("div",{staticClass:"form__input-group"},[o("ion-icon",{staticClass:"form__icon",attrs:{name:"key"}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.privateRoomPassword,expression:"privateRoomPassword",modifiers:{trim:!0}}],staticClass:"form__control",attrs:{type:"password",name:"password",placeholder:"Enter Password"},domProps:{value:t.privateRoomPassword},on:{input:function(e){e.target.composing||(t.privateRoomPassword=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),o("label",{staticClass:"form__label",attrs:{for:"password"}},[t._v("Password")])],1),o("Error",{attrs:{errors:t.errors}}),o("button",{staticClass:"btn btn--clear btn--info",attrs:{type:"submit"}},[t._v("Enter Room")])],1)])],2),o("Modal",{ref:"createRoom",attrs:{name:"create-room"}},[o("template",{slot:"header"},[o("h2",{staticClass:"text-upper"},[t._v("Create Room")])]),o("template",{slot:"body"},[o("form",{staticClass:"form form--nbs pt-3",attrs:{slot:"body"},on:{submit:t.handleCreateRoom},slot:"body"},[o("div",{staticClass:"form__input-group"},[o("ion-icon",{staticClass:"form__icon",attrs:{name:"list-box"}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.room_name,expression:"room_name",modifiers:{trim:!0}}],staticClass:"form__control",attrs:{type:"text",name:"room_name",placeholder:"Enter Room Name"},domProps:{value:t.room_name},on:{input:function(e){e.target.composing||(t.room_name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),o("label",{staticClass:"form__label",attrs:{for:"room_name"}},[t._v("Room Name")])],1),o("div",{staticClass:"form__input-group"},[o("ion-icon",{staticClass:"form__icon",attrs:{name:"key"}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],staticClass:"form__control",attrs:{type:"password",name:"password",placeholder:"Enter Password",pattern:".{5,10}",title:"Password must be between 5 and 15 characters"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),o("label",{staticClass:"form__label",attrs:{for:"password"}},[t._v("Password (Optional)")])],1),o("Error",{attrs:{errors:t.errors}}),o("button",{staticClass:"btn btn--clear btn--danger",attrs:{type:"submit"}},[t._v("Create Room")])],1)])],2),o("div",{staticClass:"rooms__actions"},[o("a",{staticClass:"btn btn--info",on:{click:t.openModal}},[t._v("Create Room")]),o("a",{staticClass:"btn btn--info",on:{click:t.fetchRoomData}},[t._v("Refresh Rooms")])])],1):t._e()],1)])])},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"section__heading mt-6"},[o("span",{staticClass:"section__title"},[t._v("Room List")])])}],s=(o("ac4d"),o("8a81"),o("5df3"),o("1c4c"),o("6b54"),o("8e6e"),o("456d"),o("ac6a"),o("8615"),o("3835")),n=(o("7f7f"),o("6762"),o("2fdb"),o("55dd"),o("ade3")),i=o("bc3a"),c=o.n(i),m=o("6b12"),l=o("2f62"),u=o("2b31");function d(t,e){var o;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=p(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,i=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return n=t.done,t},e:function(t){i=!0,s=t},f:function(){try{n||null==o.return||o.return()}finally{if(i)throw s}}}}function p(t,e){if(t){if("string"===typeof t)return f(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function v(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function _(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?v(Object(o),!0).forEach((function(e){Object(n["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var h={name:"RoomList",props:["message"],components:{Modal:m["a"],Error:u["a"]},data:function(){return{rooms:[],room_name:null,privateRoomName:null,password:null,privateRoomPassword:null,searchInput:"",errorMessage:this.message,errors:[]}},computed:_(_({},Object(l["c"])(["getUserData","getRoomData","getSocket"])),{},{getPrivateRooms:function(){return this.rooms.filter((function(t){return!1===t.access}))},getPublicRooms:function(){return this.rooms.filter((function(t){return!0===t.access}))},filteredRooms:function(){var t=this;return"my_rooms"===this.searchInput.toLowerCase()?this.rooms.filter((function(e){return e.user._id===t.getUserData._id})):this.rooms.slice().sort(this.sortAlphabetical).filter((function(e){return e.name.toLowerCase().includes(t.searchInput.toLowerCase())}))}}),methods:_(_({},Object(l["b"])(["updateRoomData","addRoom","deleteRoom","saveCurrentRoom"])),{},{sortAlphabetical:function(t,e){var o=t.name.toUpperCase(),r=e.name.toUpperCase();return o<r?-1:o>r?1:0},checkLingeringUser:function(t){var e,o=this,r=d(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(a.users.some((function(t){return t._id===o.getUserData._id})))return!0}}catch(s){r.e(s)}finally{r.f()}return!1},fetchRoomData:function(){var t=this;c.a.get("/api/room").then((function(e){if(t.checkLingeringUser(e.data))return c.a.put("/api/room/remove/users/all",{user_id:t.getUserData._id});t.$store.dispatch("updateRoomData",e.data),t.rooms=e.data})).then((function(e){e&&e.data&&(t.rooms=e.data)})).catch((function(t){console.log(t)}))},openModal:function(){this.$refs.createRoom.open()},enterRoom:function(t){this.$router.push({name:"Room",params:{id:t._id}})},handleCreateRoom:function(t){var e=this;t.preventDefault(),c.a.post("/api/room",{room_name:this.room_name,password:this.password}).then((function(t){if(t.data.errors){var o,r=d(t.data.errors);try{for(r.s();!(o=r.n()).done;){var a=o.value,n=Object.values(a),i=Object(s["a"])(n,1),c=i[0];e.errors.push(c)}}catch(m){r.e(m)}finally{r.f()}}else e.$store.dispatch("addRoom",t.data),e.room_name=null,e.password=null,e.$refs.createRoom.close(),e.getSocket.emit("roomAdded",t.data)})).catch((function(t){console.log(t)})),setTimeout((function(){e.errors=[]}),1500)},handleDelete:function(t){var e=this;t.preventDefault(),c.a.delete("/api/room/".concat(t.target.name)).then((function(t){e.$store.dispatch("deleteRoom",t.data),e.getSocket.emit("roomDeleted",{room:t.data,user:e.getUserData,admin:!0,content:"".concat(t.data.user.username," deleted room ").concat(t.data.name)})})).catch((function(t){return console.log(t)}))},handleRoomClick:function(t){t.access||this.getUserData._id===t.user._id||t.accessIds.includes(this.getUserData._id)?this.enterRoom(t):(this.privateRoomName=t.name,this.$refs.privateRoom.setData("room",t),this.$refs.privateRoom.open())},handlePrivateRoomCheck:function(t){var e=this;t.preventDefault(),c.a.post("/api/room/verify",{room_name:this.$refs.privateRoom.modalData.room.name,password:this.privateRoomPassword}).then((function(t){if(t.data.errors){var o,r=d(t.data.errors);try{for(r.s();!(o=r.n()).done;){var a=o.value,n=Object.keys(a),i=Object(s["a"])(n,1),c=i[0],m=Object.values(a),l=Object(s["a"])(m,1),u=l[0];e.errors.push({key:c,value:u})}}catch(p){r.e(p)}finally{r.f()}e.privateRoomPassword=null}else t.data.success&&e.enterRoom(e.$refs.privateRoom.modalData.room);setTimeout((function(){e.errors=[]}),1500)})).catch((function(t){return console.log(t)}))}}),created:function(){var t=this;this.getSocket.on("roomAdded",(function(e){t.rooms.unshift(JSON.parse(e))})),this.getSocket.on("roomListUpdated",(function(e){t.rooms=t.rooms.filter((function(t){return t._id!==JSON.parse(e).room._id}))})),this.getSocket.on("updateRooms",(function(e){t.rooms=JSON.parse(e).room})),this.getSocket.on("roomNameUpdated",(function(e){var o=0;t.rooms.forEach((function(t,r){t._id===JSON.parse(e).room._id&&(o=r)})),t.rooms.splice(o,1,JSON.parse(e).room)}))},mounted:function(){var t=this;this.fetchRoomData(),this.errorMessage&&setTimeout((function(){t.errorMessage=""}),1500)}},b=h,g=(o("3772"),o("2877")),R=Object(g["a"])(b,r,a,!1,null,null,null);e["default"]=R.exports},"9f2b":function(t,e,o){}}]);
//# sourceMappingURL=chunk-2806a9d2.2298d6f8.js.map